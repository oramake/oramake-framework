title: Установка

group: Общие замечания

Параметры установки:
INSTALL_VERSION               - устанавливаемая версия схемы ( Last при
                                первоначальной установке или номер при
                                обновлении, например 1.1.0)
LOAD_OPERATORID               - логин и пароль оператора, выполняющего установку
                                ( формат: login/password)
LOAD_USERID                   - основная схема для установки
                                ( формат: username/password@dbName)
TO_USERNAME                   - имя пользователя, которому выдаются права
                                ( формат: username)



Перед установкой модуль деактивирует пакетные задания модуля Scheduler в
БД, а после успешной установки восстанавливает активацию.

Команда для восстановления выполнения заданий в БД на случай ошибок:

> make install-after LOAD_USERID=???/???@??? LOAD_OPERATORID=???/???



group: 2.6.0

Команда для установки:

> make install INSTALL_VERSION=2.6.0 LOAD_USERID=???/???@??? LOAD_OPERATORID=???/???

Замечания:
- для выполнения SSL-авторизации на SMTP-сервере нужно в пакетном задании
  SendMailHandler указать значения параметров авторизации (Username, Password)
  либо задавать эти значения при вызове функции <pkg_Mail.sendMail>;
- в случае ошибки из-за отсутствия прав на уровне Java на подключение по порту
  465 (используется при SSL-авторизации на SMTP-сервере, выданные права можно
  посмотреть в USER_JAVA_POLICY) можно выдать права командой
  (в LOAD_USERID указывается привилегированный пользователь, в TO_USERNAME
  указывается пользователь, под которым установлен модуль):

> make grant INSTALL_VERSION=2.6.0 LOAD_USERID=???/???@??? LOAD_OPERATORID=???/??? GRANT_SCRIPT=sys-privs TO_USERNAME=??? SKIP_FILE_MASK=*/oms-check-grant-version.sql



group: 2.5.0
(<Версии::2.5.0 ( 2019-01-18)>)

Порядок установки:

- установка в основную схему:

(code)

make install INSTALL_VERSION=2.5.0 LOAD_USERID=???/???@??? LOAD_OPERATORID=???/???

(end code)



group: 2.3.0

Порядок установки:

- установка в основную схему;

(code)

make install INSTALL_VERSION=2.3.0 LOAD_USERID=???/???@??? LOAD_OPERATORID=???/???

(end code)



group: 2.2.0

Порядок установки:

- удаление Java-библиотек *с помощью предыдущего релиза (ИЗ ТЕГА 2.1.0)*;

(code)

make uninstall INSTALL_VERSION=Last LOAD_USERID=???/???@??? FILE_MASK=*jar -Bi

(end code)

- установка в основную схему;

(code)

make install INSTALL_VERSION=2.2.0 LOAD_USERID=???/???@??? LOAD_OPERATORID=???/???

(end code)



group: 2.1.0

Порядок установки:

- установка в основную схему;

(code)

make install INSTALL_VERSION=2.1.0 LOAD_USERID=???/???@??? LOAD_OPERATORID=???/???

(end code)



group: 2.0.2

Команда для установки обновления:

(code)

$ make install INSTALL_VERSION=2.0.2 LOAD_USERID=???/???@??? LOAD_OPERATORID=???/???

(end)

Замечания:
- установка версии 2.0.2 может выполняться на версию 2.0.0 ( т.е. версию 2.0.1
  можно предварительно не устанавливать, изменения по версии 2.0.1 будут
  установлены при установке версии 2.0.2);



group: 2.0.1

Команда для установки обновления:

(code)

$ make install INSTALL_VERSION=2.0.1 LOAD_USERID=???/???@??? LOAD_OPERATORID=???/???

(end)



group: 2.0.0

Команда для установки обновления:

(code)

$ make install INSTALL_VERSION=2.0.0 LOAD_USERID=???/???@??? LOAD_OPERATORID=???/???

(end)



group: Первоначальная установка

Предварительные требования:
- наличие Oracle JVM ( Oracle JAVA Virtual Machine) в БД Oracle;
- установка модуля Common;
- установка модуля Logging;
- установка модуля AccessOperator;
- установка модуля Option;
- установка модуля Scheduler;
- установка модуля TaskHandler;

Порядок для первоначальной установки последней версии модуля:

- выдача дополнительных прав на системные объекты ( в TO_USERNAME указывается
  пользователь, в схему которого будет установлен модуль)

(code)

$ make grant INSTALL_VERSION=Last LOAD_USERID=sys/???@??? LOAD_OPERATORID=???/??? GRANT_SCRIPT=sys-privs TO_USERNAME=???

(end)

( в случае, если у пользователя, под которым выдаются права, нет прав на
использование модуля ModuleInfo, то нужно отключить сохранение информации об
установке в ModuleInfo, дополнив команду строкой
"  OMS_SAVE_FILE_INSTALL_INFO=0 SKIP_FILE_MASK=*/oms-save-grant-info.sql"
и можно не указывать LOAD_OPERATORID
)

- установка объектов модуля

(code)

$ make install INSTALL_VERSION=Last LOAD_USERID=???/???@??? LOAD_OPERATORID=???/???

(end)



group: Выдача прав на использование модуля

Команда для выдачи прав:

(code)

$ make grant LOAD_USERID=???/??? LOAD_OPERATORID=???/??? TO_USERNAME=???

(end)

Замечания:
- для выдачи прав всем пользователям в TO_USERNAME нужно указать public
  ( " TO_USERNAME=public"), при этом у пользователя, в схему которого
  установлен модуль, должна быть системная привилегия "CREATE PUBLIC SYNONYM";



group: Выполнение тестов

Предварительные требования:
- установка модуля TestUtility;

Команда установки объектов для выполнения тестов ( можно также сразу установить
параметры тестирования с помощью <SQL_DEFINE>, см. следующий пример):

(code)

$ make install-test LOAD_USERID=???/???@??? LOAD_OPERATORID=???/???

(end)

Команда для изменения параметров тестирования ( перечислены
в <pkg_MailTest::Параметры тестирования>, в примере устанавливается значение
SMTP-сервера ( <pkg_MailTest.TestSmtpServer_OptSName>) в "smtp.company.com"):

(code)

$ make -B install-test LOAD_USERID=???/???@??? LOAD_OPERATORID=???/??? FILE_MASK=*/opt_option.sql SQL_DEFINE=TestSmtpServer=smtp.company.com

(end)

Команда для выполнения всех тестов:

(code)

$ make test LOAD_USERID=???/???@??? LOAD_OPERATORID=???/???

(end)


group: Удаление модуля из БД

Команда для удаления модуля из БД:

(code)

$ make uninstall INSTALL_VERSION=Last LOAD_USERID=???/???@??? LOAD_OPERATORID=???/???

(end)
