<!DOCTYPE html PUBLIC "-//W3C//DTD HTML 4.0 Transitional//EN">
<html>
<head>

  


  
  <title>How to use active or passive mode</title>
  <meta name="generator" content="HelpMaker.net">


  
  <meta name="keywords" content="Chapter 3,">


  
  <link rel="stylesheet" type="text/css" href="ms-help://Hx/HxRuntime/HxLink.css">


  
  <link rel="stylesheet" type="text/css" href="ms-help://Hx/HxRuntime/HxLinkDefault.css">
</head>


<body style="background-color: rgb(255, 255, 255);">


<table cellpadding="0" cellspacing="0" width="100%">


  <tbody>


    <tr>


      <td style="background-image: url(../images/bk_tl.jpg); background-repeat: repeat-x;"><img src="../images/space.gif" height="4" width="4"></td>


      <td style="background-image: url(../images/bk_t.jpg); background-repeat: repeat-x;"><img src="../images/space.gif" height="4" width="4"></td>


      <td style="background-image: url(../images/bk_tr.jpg); background-repeat: repeat-x;"><img src="../images/space.gif" height="4" width="4"></td>


    </tr>


    <tr>


      <td style="background-image: url(../images/bk_l.jpg); background-repeat: repeat-y;" width="4"><img src="../images/space.gif" height="4" width="4"></td>


      <td style="font-family: sans-serif; font-weight: bold; font-size: 14pt; background-image: url(../images/bk_c.jpg); background-repeat: repeat;" width="100%"> &nbsp;How to use active or passive mode </td>


      <td style="background-image: url(../images/bk_r.jpg); background-repeat: repeat-y;" width="4"><img src="../images/space.gif" height="4" width="4"></td>


    </tr>


    <tr>


      <td style="background-image: url(../images/bk_bl.jpg); background-repeat: repeat-x;" height="4"><img src="../images/space.gif" height="4" width="4"></td>


      <td style="background-image: url(../images/bk_b.jpg); background-repeat: repeat-x;"><img src="../images/space.gif" height="4" width="4"></td>


      <td style="background-image: url(../images/bk_br.jpg); background-repeat: repeat-x;"><img src="../images/space.gif" height="4" width="4"></td>


    </tr>


  
  </tbody>
</table>


<br>


<div align="left"> <font color="#010101" face="Arial"><span style="font-size: 10pt;">In
the FTP and FTPS protocols, data transfers are made on a different
connection to the control connection - and a new connection is made for
each data transfer. This is not the case for SFTP, where all control
information and data is transferred on the same connection. Connect
modes are thus only relevant to <a href="../../api/com/enterprisedt/net/ftp/FTPClient.html"><font color="#0000ff" face="Arial"><span style="font-size: 10pt;"><u>FTPClient</u></span></font></a>,
<a href="../../api/com/enterprisedt/net/ftp/ssl/SSLFTPClient.html"><font color="#0000ff" face="Arial"><span style="font-size: 10pt;"><u>SSLFTPClient</u></span></font></a>,
and <a href="../../api/com/enterprisedt/net/ftp/pro/ProFTPClient.html"><font color="#0000ff" face="Arial"><span style="font-size: 10pt;"><u>ProFTPClient</u></span></font></a>
classes. </span></font> </div>


<div align="left"> <br>


<font color="#010101" face="Arial"><span style="font-size: 10pt;">In FTP and FTPS, data connections
can be made in two different ways - the server initiating the
connection (active mode) or the client initiating the connection
(passive mode). For more discussion on connect modes, see <a href="activeandpassivemodes.html"><font color="#0000ff" face="Arial"><span style="font-size: 10pt;"><u>
Active and Passive Modes.</u></span></font></a>
The connect mode has certain implications for FTP'ing through firewalls
- see <a href="howtoftpthroughafilewall.html"><font color="#0000ff" face="Arial"><span style="font-size: 10pt;"><u> How to FTP through a NAT
router/firewall.</u></span></font></a></span></font>
</div>


<div align="left"> <br>


</div>


<div align="left"> <font color="#010101" face="Arial"><span style="font-size: 10pt;"><b>Active
Mode</b></span></font> </div>


<div align="left"> <br>


<font color="#010101" face="Arial"><span style="font-size: 10pt;">To use active mode, the <a href="../../api/com/enterprisedt/net/ftp/FTPClient.html#setConnectMode%28com.enterprisedt.net.ftp.FTPConnectMode%29"><font color="#0000ff" face="Lucida Console" size="1"><span style="font-size: 8pt;"><u>setConnectMode()</u></span></font></a>
method should be used, supplying the ACTIVE mode as shown:</span></font>
</div>

<div style="margin-left: 13mm; margin-right: 0mm; text-indent: 0mm;" align="left"> <br>

<font color="#010101" face="Lucida Console" size="1"><span style="font-size: 8pt;">ftp.</span></font><a href="../../api/com/enterprisedt/net/ftp/FTPClient.html#setConnectMode%28com.enterprisedt.net.ftp.FTPConnectMode%29"><font color="#0000ff" face="Lucida Console" size="1"><span style="font-size: 8pt;"><u>setConnectMode(FTPConnectMode.ACTIVE)</u></span></font></a><font face="Lucida Console" size="1"><span style="font-size: 8pt;">;<br>


<br>


</span></font> </div>

<div align="left">
<font color="#010101" face="Arial"><span style="font-size: 10pt;">Note that
in active mode, the client supplies the port number to which the server connects.
This is normally a random port, but a port range can be specified (for example a
permissable range that is configured in a firewall). Use the 
<a href="../../api/com/enterprisedt/net/ftp/FTPClient.html#setActivePortRange(int,%20int)"><font color="#0000ff" face="Lucida Console" size="1"><span style="font-size: 8pt;"><u>setActivePortRange()</u></span></font></a>
method to set the range, e.g.
</div>

<div style="margin-left: 13mm; margin-right: 0mm; text-indent: 0mm;" align="left"> <br>
<font color="#010101" face="Lucida Console" size="1"><span style="font-size: 8pt;">ftp.setActivePortRange(12000, 12020);</span></font><br>
<br>
</span></font> </div>


<div align="left">
<font color="#010101" face="Arial"><span style="font-size: 10pt;">
The port number being sent to the server can be found from
the log file (in DEBUG mode), looking for the PORT command, e.g.
</div>

<div style="margin-left: 13mm; margin-right: 0mm; text-indent: 0mm;" align="left"> <br>
<font color="#010101" face="Lucida Console" size="1"><span style="font-size: 8pt;">PORT 151,134,10,195,240,68</span></font><br>
</span></font> </div>

<div align="left"> <br>

<div align="left">
<font color="#010101" face="Arial"><span style="font-size: 10pt;">
The first four numbers are the IP address, and the last two form the port number. To calculate the port number
that the server will try to connect to, multiple the first port number by 256 (2^8), and then add the second port number.
In the example it will be 240*(2^8) + 68, yielding a port number of 61508.
</div>

<div align="left"> <br>

<div align="left"> <font color="#010101" face="Arial"><span style="font-size: 10pt;"><b>ASCII
Mode</b></span></font> </div>


<div align="left"> <br>


<font color="#010101" face="Arial"><span style="font-size: 10pt;">To use passive mode, the&nbsp;</span></font><font color="#010101" face="Arial"><span style="font-size: 10pt;"></span></font><font><u><font color="#010101" face="Arial"><a href="../../api/com/enterprisedt/net/ftp/FTPClient.html#setConnectMode%28com.enterprisedt.net.ftp.FTPConnectMode%29"><font color="#0000ff" face="Lucida Console" size="1"><span style="font-size: 8pt;"><u>setConnectMode()</u></span></font></a></font></u></font><font color="#010101" face="Arial"><span style="font-size: 10pt;">
method should be used, supplying the PASV type as shown.</span></font>
</div>


<div style="margin-left: 13mm; margin-right: 0mm; text-indent: 0mm;" align="left"> <br>


<font color="#010101" face="Lucida Console" size="1"><span style="font-size: 8pt;">ftp.</span></font><a href="../../api/com/enterprisedt/net/ftp/FTPClient.html#setConnectMode%28com.enterprisedt.net.ftp.FTPConnectMode%29"><font color="#0000ff" face="Lucida Console" size="1"><span style="font-size: 8pt;"><u>setConnectMode(FTPConnectMode.PASV)</u></span></font></a><font face="Lucida Console" size="1"><span style="font-size: 8pt;"></span></font><font face="Lucida Console" size="1"><span style="font-size: 8pt;">;<br>


</span></font> </div>


<div align="left"> <br>


<font color="#010101" face="Arial"><span style="font-size: 10pt;">If
problems are being experienced with file transfers and directory
listings (both of which use a new data connection), it is likely that a
firewall is preventing the creation of the data connection. Try
swapping from active to passive modes, or vice versa.&nbsp;</span></font><font color="#010101" face="Arial"><span style="font-size: 10pt;">If this doesn't work, please refer to</span></font><a href="../../../../../tmp/jpro-html/howtoftpthroughafilewall.html"><font color="#010101" face="Arial"><span style="font-size: 10pt;"></span></font><font><u><font color="#010101" face="Arial"><a href="howtoftpthroughafilewall.html"><font color="#0000ff" face="Arial"><span style="font-size: 10pt;"><u> How to FTP through a NAT
router/firewall.</u></span></font></a></font></u></font></a>
</div>


</body>
</html>
