<!DOCTYPE html PUBLIC "-//W3C//DTD HTML 4.0 Transitional//EN">
<html>
<head>
  <title>How to monitor transfers and commands</title>


  <meta name="generator" content="HelpMaker.net">

  <meta name="keywords" content="Chapter 3,">

  <link rel="stylesheet" type="text/css" href="ms-help://Hx/HxRuntime/HxLink.css">

  <link rel="stylesheet" type="text/css" href="ms-help://Hx/HxRuntime/HxLinkDefault.css">

</head>


<body style="background-color: rgb(255, 255, 255);">
    <table cellpadding="0" cellspacing="0" width="100%">
      <tr>
        <td style="background-image:url(../images/bk_tl.jpg); background-repeat: repeat-x"><img src="../images/space.gif" width=4 height=4></td>
        <td style="background-image:url(../images/bk_t.jpg); background-repeat: repeat-x"><img src="../images/space.gif" width=4 height=4></td>
        <td style="background-image:url(../images/bk_tr.jpg); background-repeat: repeat-x"><img src="../images/space.gif" width=4 height=4></td>
      </tr>
      <tr>
        <td width="4" style="background-image:url(../images/bk_l.jpg); background-repeat: repeat-y"><img src="../images/space.gif" width=4 height=4></td>
        <td width="100%" style="font-family: sans-serif; font-weight: bold; font-size: 14pt; background-image:url(../images/bk_c.jpg); background-repeat: repeat">
          &nbsp;How to monitor transfers and commands
        </td>
        <td width="4" style="background-image:url(../images/bk_r.jpg); background-repeat: repeat-y"><img src="../images/space.gif" width=4 height=4></td>
      </tr>
      <tr>
        <td height="4" style="background-image:url(../images/bk_bl.jpg); background-repeat: repeat-x"><img src="../images/space.gif" width=4 height=4></td>
        <td style="background-image:url(../images/bk_b.jpg); background-repeat: repeat-x"><img src="../images/space.gif" width=4 height=4></td>
        <td style="background-image:url(../images/bk_br.jpg); background-repeat: repeat-x"><img src="../images/space.gif" width=4 height=4></td>
      </tr>
    </table>
<br>
<div align="left"> <font color="#010101" face="Arial"><span style="font-size: 10pt;">It
can be very useful to be able to monitor FTP transfers, that is, to
receive programmatic feedback on how the transfer is progressing.
Similarly, it can be useful to obtain the commands that are being sent
back and forth.&nbsp;</span></font>
</div>

<div align="left"> <br>

</div>

<div align="left"> <font color="#010101" face="Arial"><span style="font-size: 10pt;"><b>Progress
monitoring</b></span></font> </div>

<div align="left"> <br>

</div>

<div align="left"> <font color="#010101" face="Arial"><span style="font-size: 10pt;">The
<a href="../../api/com/enterprisedt/net/ftp/FTPProgressMonitor.html">FTPProgressMonitor</a>
interface is used to monitor the number of bytes being
transferred.&nbsp;Typically, the developer
implements this interface in their own class (perhaps as an anonymous
class). An instance is set via <a href="../../api/com/enterprisedt/net/ftp/FTPClientInterface.html#setProgressMonitor%28com.enterprisedt.net.ftp.FTPProgressMonitor%29">setProgressMonitor</a>,
and once the transfer begins, the instance is notified periodically
during the transfer of how many bytes have been transferred up to that
point. <a href="../../api/com/enterprisedt/net/ftp/FTPClientInterface.html#setProgressMonitor%28com.enterprisedt.net.ftp.FTPProgressMonitor,%20long%29">setProgressMonitor</a>
optionally permits an interval to be passed
in, so that the notification period (i.e. the number of bytes
transferred) can be altered. <a href="../../api/com/enterprisedt/net/ftp/FTPClientInterface.html#getMonitorInterval%28%29">getMonitorInterval</a>
returns the interval currently being used.</span></font> </div>

<br>

<div align="left">
<div align="left"><font color="#010101" face="Arial"><span style="font-size: 10pt;">An
example of progress monitor usage is shown below. Firstly the
implementation is defined, and then an instance set in the client:</span></font>
<div align="left"> <br>

</div>

<div style="margin-left: 13mm; margin-right: 0mm; text-indent: 0mm;" align="left"><font face="Lucida Console" size="1"><span style="font-size: 8pt;">
// progress monitor that logs progress<br>

class LogProgressMonitor implements FTPProgressMonitor {
<br>

&nbsp;&nbsp;public void bytesTransferred(long bytes) {<br>

&nbsp;&nbsp;&nbsp;&nbsp;log.debug(bytes + "
transferred");<br>

&nbsp;&nbsp;}<br>

}<br>

<br>

ftp.<a href="../../api/com/enterprisedt/net/ftp/FTPClientInterface.html#setProgressMonitor%28com.enterprisedt.net.ftp.FTPProgressMonitor,%20long%29">setProgressMonitor</a>(new
LogProgressMonitor(), 100000);
</span></font></div>

<div align="left"> <br>

</div>

<div align="left"><font color="#010101" face="Arial"><span style="font-size: 10pt;">More
sophisticated usages might be to display a progress bar in a GUI. For
this to be achieved, first obtain the size of file via the <a href="../../api/com/enterprisedt/net/ftp/FTPClientInterface.html#size%28java.lang.String%29">size</a>
method. Then progress can be accurated estimately and displayed.</span></font>
</div>

<div align="left"> <br>

</div>

<div align="left"> <span style="font-family: Arial;"><span style="font-weight: bold;">Command</span></span><font color="#010101" face="Arial"><span style="font-size: 10pt;"><b> monitoring</b></span></font>
</div>

<div align="left"> <br>

</div>

<div align="left"><font color="#010101" face="Arial"><span style="font-size: 10pt;">The
<a href="../../api/com/enterprisedt/net/ftp/FTPMessageListener.html">FTPMessageListener</a>
interface </span></font><font color="#010101" face="Arial"><span style="font-size: 10pt;">provides
a means of obtaining the commands that are sent between
client and FTP server. This includes but is not limited to transfer
commands - all commands can be collected. This is mainly useful for
debugging purposes. The developer implements this
interface in their own class, and an instance is set via <a href="../../api/com/enterprisedt/net/ftp/FTPClient.html#setMessageListener%28com.enterprisedt.net.ftp.FTPMessageListener%29">setMessageListener</a>.
From that point on, all commands (from client to server and from server
to client) are provided to this instance. An example is shown below
that logs all commands:</span></font>
</div>

<div align="left"> <br>

</div>

<div style="margin-left: 13mm; margin-right: 0mm; text-indent: 0mm;" align="left"><font face="Lucida Console" size="1"><span style="font-size: 8pt;">
// progress monitor that logs progress<br>

class LogMessageListener implements FTPMessageListener {
<br>

&nbsp;&nbsp;public void logCommand(String cmd) {<br>

&nbsp;&nbsp;&nbsp;&nbsp;log.debug("Command: " + cmd);<br>

&nbsp;&nbsp;}<br>

&nbsp;&nbsp;public void logReply(String reply) {<br>

&nbsp;&nbsp;&nbsp;&nbsp;log.debug("Reply:&nbsp;" +
reply);<br>

&nbsp;&nbsp;}<br>

}<br>

<br>

ftp.<a href="../../api/com/enterprisedt/net/ftp/FTPClient.html#setMessageListener%28com.enterprisedt.net.ftp.FTPMessageListener%29">setMessageListener</a>(new&nbsp;</span></font><font face="Lucida Console" size="1"><span style="font-size: 8pt;">LogMessageListener</span></font><font face="Lucida Console" size="1"><span style="font-size: 8pt;">());
</span></font></div>

<div align="left"> <br>

</div>

<font color="#010101" face="Arial"><span style="font-size: 10pt;">For convenience, the <a href="../../api/com/enterprisedt/net/ftp/FTPMessageCollector.html">FTPMessageCollector</a>
class is provided. This is an implementation of </span></font><font color="#010101" face="Arial"><span style="font-size: 10pt;"><a href="../../api/com/enterprisedt/net/ftp/FTPMessageListener.html">FTPMessageListener</a></span></font><font color="#010101" face="Arial"><span style="font-size: 10pt;"> that </span></font><font color="#010101" face="Arial"><span style="font-size: 10pt;">maintains a log of messages (as a
single string) which can be obtained at any time.
</span></font>
<div align="left"> 
<br>

</div>

</div>

</div>

</body>
</html>
