<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN" "http://www.w3.org/TR/html4/loose.dtd">
<!--NewPage-->
<HTML>
<HEAD>
<!-- Generated by javadoc (build 1.6.0) on Thu Apr 03 09:51:10 EST 2008 -->
<TITLE>
SSLFTPStandardValidator (edtFTPj/PRO by Enterprise Distributed Technologies Ltd)
</TITLE>

<META NAME="date" CONTENT="2008-04-03">

<LINK REL ="stylesheet" TYPE="text/css" HREF="../../../../../stylesheet.css" TITLE="Style">

<SCRIPT type="text/javascript">
function windowTitle()
{
    if (location.href.indexOf('is-external=true') == -1) {
        parent.document.title="SSLFTPStandardValidator (edtFTPj/PRO by Enterprise Distributed Technologies Ltd)";
    }
}
</SCRIPT>
<NOSCRIPT>
</NOSCRIPT>

</HEAD>

<BODY BGCOLOR="white" onload="windowTitle();">
<HR>


<!-- ========= START OF TOP NAVBAR ======= -->
<A NAME="navbar_top"><!-- --></A>
<A HREF="#skip-navbar_top" title="Skip navigation links"></A>
<TABLE BORDER="0" WIDTH="100%" CELLPADDING="1" CELLSPACING="0" SUMMARY="">
<TR>
<TD COLSPAN=2 BGCOLOR="#EEEEFF" CLASS="NavBarCell1">
<A NAME="navbar_top_firstrow"><!-- --></A>
<TABLE BORDER="0" CELLPADDING="0" CELLSPACING="3" SUMMARY="">
  <TR ALIGN="center" VALIGN="top">
  <TD BGCOLOR="#EEEEFF" CLASS="NavBarCell1">    <A HREF="../../../../../overview-summary.html"><FONT CLASS="NavBarFont1"><B>Overview</B></FONT></A>&nbsp;</TD>
  <TD BGCOLOR="#EEEEFF" CLASS="NavBarCell1">    <A HREF="package-summary.html"><FONT CLASS="NavBarFont1"><B>Package</B></FONT></A>&nbsp;</TD>
  <TD BGCOLOR="#FFFFFF" CLASS="NavBarCell1Rev"> &nbsp;<FONT CLASS="NavBarFont1Rev"><B>Class</B></FONT>&nbsp;</TD>
  <TD BGCOLOR="#EEEEFF" CLASS="NavBarCell1">    <A HREF="class-use/SSLFTPStandardValidator.html"><FONT CLASS="NavBarFont1"><B>Use</B></FONT></A>&nbsp;</TD>
  <TD BGCOLOR="#EEEEFF" CLASS="NavBarCell1">    <A HREF="package-tree.html"><FONT CLASS="NavBarFont1"><B>Tree</B></FONT></A>&nbsp;</TD>
  <TD BGCOLOR="#EEEEFF" CLASS="NavBarCell1">    <A HREF="../../../../../deprecated-list.html"><FONT CLASS="NavBarFont1"><B>Deprecated</B></FONT></A>&nbsp;</TD>
  <TD BGCOLOR="#EEEEFF" CLASS="NavBarCell1">    <A HREF="../../../../../index-all.html"><FONT CLASS="NavBarFont1"><B>Index</B></FONT></A>&nbsp;</TD>
  <TD BGCOLOR="#EEEEFF" CLASS="NavBarCell1">    <A HREF="../../../../../help-doc.html"><FONT CLASS="NavBarFont1"><B>Help</B></FONT></A>&nbsp;</TD>
  </TR>
</TABLE>
</TD>
<TD ALIGN="right" VALIGN="top" ROWSPAN=3><EM>
</EM>
</TD>
</TR>

<TR>
<TD BGCOLOR="white" CLASS="NavBarCell2"><FONT SIZE="-2">
&nbsp;<A HREF="../../../../../com/enterprisedt/net/ftp/ssl/SSLFTPSecurityMechanism.html" title="class in com.enterprisedt.net.ftp.ssl"><B>PREV CLASS</B></A>&nbsp;
&nbsp;<A HREF="../../../../../com/enterprisedt/net/ftp/ssl/SSLFTPValidator.html" title="interface in com.enterprisedt.net.ftp.ssl"><B>NEXT CLASS</B></A></FONT></TD>
<TD BGCOLOR="white" CLASS="NavBarCell2"><FONT SIZE="-2">
  <A HREF="../../../../../index.html?com/enterprisedt/net/ftp/ssl/SSLFTPStandardValidator.html" target="_top"><B>FRAMES</B></A>  &nbsp;
&nbsp;<A HREF="SSLFTPStandardValidator.html" target="_top"><B>NO FRAMES</B></A>  &nbsp;
&nbsp;<SCRIPT type="text/javascript">
  <!--
  if(window==top) {
    document.writeln('<A HREF="../../../../../allclasses-noframe.html"><B>All Classes</B></A>');
  }
  //-->
</SCRIPT>
<NOSCRIPT>
  <A HREF="../../../../../allclasses-noframe.html"><B>All Classes</B></A>
</NOSCRIPT>


</FONT></TD>
</TR>
<TR>
<TD VALIGN="top" CLASS="NavBarCell3"><FONT SIZE="-2">
  SUMMARY:&nbsp;NESTED&nbsp;|&nbsp;<A HREF="#field_summary">FIELD</A>&nbsp;|&nbsp;<A HREF="#constructor_summary">CONSTR</A>&nbsp;|&nbsp;<A HREF="#method_summary">METHOD</A></FONT></TD>
<TD VALIGN="top" CLASS="NavBarCell3"><FONT SIZE="-2">
DETAIL:&nbsp;<A HREF="#field_detail">FIELD</A>&nbsp;|&nbsp;<A HREF="#constructor_detail">CONSTR</A>&nbsp;|&nbsp;<A HREF="#method_detail">METHOD</A></FONT></TD>
</TR>
</TABLE>
<A NAME="skip-navbar_top"></A>
<!-- ========= END OF TOP NAVBAR ========= -->

<HR>
<!-- ======== START OF CLASS DATA ======== -->
<H2>
<FONT SIZE="-1">
com.enterprisedt.net.ftp.ssl</FONT>
<BR>
Class SSLFTPStandardValidator</H2>
<PRE>
java.lang.Object
  <IMG SRC="../../../../../resources/inherit.gif" ALT="extended by "><B>com.enterprisedt.net.ftp.ssl.SSLFTPStandardValidator</B>
</PRE>
<DL>
<DT><B>All Implemented Interfaces:</B> <DD><A HREF="../../../../../com/enterprisedt/net/ftp/ssl/SSLFTPValidator.html" title="interface in com.enterprisedt.net.ftp.ssl">SSLFTPValidator</A></DD>
</DL>
<HR>
<DL>
<DT><PRE>public class <B>SSLFTPStandardValidator</B><DT>extends java.lang.Object<DT>implements <A HREF="../../../../../com/enterprisedt/net/ftp/ssl/SSLFTPValidator.html" title="interface in com.enterprisedt.net.ftp.ssl">SSLFTPValidator</A></DL>
</PRE>

<P>
<p>
 Standard server certificate validator (<A HREF="../../../../../com/enterprisedt/net/ftp/ssl/SSLFTPValidator.html" title="interface in com.enterprisedt.net.ftp.ssl"><CODE>SSLFTPValidator</CODE></A>). This
 validator performs the following validation tests:
 </p>
 <ol>
 <li>Check to see if the client recommends that the certificate should be
 accepted.  This happens if (1) the server's certificate was 
 verified from the root certificates store (see
 <A HREF="../../../../../com/enterprisedt/net/ftp/ssl/SSLFTPClient.html#getRootCertificateStore()"><CODE>SSLFTPClient.getRootCertificateStore()</CODE></A>).
 or (2) server validation has been switched off 
 see <A HREF="../../../../../com/enterprisedt/net/ftp/ssl/SSLFTPClient.html#setValidateServer(boolean)"><CODE>SSLFTPClient.setValidateServer(boolean)</CODE></A>). 
 <li>Ensure that the length of the certificate chain is no more than 2,
 which indicates that the certificate was issued to the server directly by a
 CA (Certificate Authority).
 <li>Check that the CN (Common Name) of the subject of the server
 certificate matches the server's hostname.
 <li>Check that today's date is within the valid period of the certificate.
 </ol>
 <p>
 The second test, host-name checking, is sometimes problematic and
 may be disabled by passing a flag to the constructor.  This, however,
 is <b>strongly discouraged</b> and should be done only if the
 FTPS server's certificate cannot be configured so that its CN parameter
 contains its host-name.
 </p>
 <p>  
 Be warned that disabling host-name checking opens the opportunity 
 for man-in-the-middle attacks.  This scenario is when an attacker has 
 stolen the certificate and private key of a server, and then set up 
 another server using these with the aim of impersonating the former. 
 Since internet naming is such that only one server can have a particular 
 host-name, it is very difficult for the attacker to make their 
 host-name match the host-name on the certificate.  However, 
 if the host-name is not matched with the name on the certificate
 then this possibility opens.
 </p>
<P>

<P>
<DL>
<DT><B>Author:</B></DT>
  <DD>Hans Andersen</DD>
</DL>
<HR>

<P>
<!-- =========== FIELD SUMMARY =========== -->

<A NAME="field_summary"><!-- --></A>
<TABLE BORDER="1" WIDTH="100%" CELLPADDING="3" CELLSPACING="0" SUMMARY="">
<TR BGCOLOR="#CCCCFF" CLASS="TableHeadingColor">
<TH ALIGN="left" COLSPAN="2"><FONT SIZE="+2">
<B>Field Summary</B></FONT></TH>
</TR>
<TR BGCOLOR="white" CLASS="TableRowColor">
<TD ALIGN="right" VALIGN="top" WIDTH="1%"><FONT SIZE="-1">
<CODE>protected &nbsp;boolean</CODE></FONT></TD>
<TD><CODE><B><A HREF="../../../../../com/enterprisedt/net/ftp/ssl/SSLFTPStandardValidator.html#hostNameCheckingEnabled">hostNameCheckingEnabled</A></B></CODE>

<BR>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Flag indicating whether or not host-name checking is enabled.</TD>
</TR>
<TR BGCOLOR="white" CLASS="TableRowColor">
<TD ALIGN="right" VALIGN="top" WIDTH="1%"><FONT SIZE="-1">
<CODE>static&nbsp;int</CODE></FONT></TD>
<TD><CODE><B><A HREF="../../../../../com/enterprisedt/net/ftp/ssl/SSLFTPStandardValidator.html#MAX_CERTIFICATE_CHAIN_LENGTH">MAX_CERTIFICATE_CHAIN_LENGTH</A></B></CODE>

<BR>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Maximum allowed length of the certificate chain.</TD>
</TR>
<TR BGCOLOR="white" CLASS="TableRowColor">
<TD ALIGN="right" VALIGN="top" WIDTH="1%"><FONT SIZE="-1">
<CODE>protected &nbsp;<A HREF="../../../../../com/enterprisedt/net/ftp/ssl/SSLFTPCertificateStore.html" title="class in com.enterprisedt.net.ftp.ssl">SSLFTPCertificateStore</A></CODE></FONT></TD>
<TD><CODE><B><A HREF="../../../../../com/enterprisedt/net/ftp/ssl/SSLFTPStandardValidator.html#rootCertificateStore">rootCertificateStore</A></B></CODE>

<BR>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Reference to SSLFTPClient's root certificate store.</TD>
</TR>
<TR BGCOLOR="white" CLASS="TableRowColor">
<TD ALIGN="right" VALIGN="top" WIDTH="1%"><FONT SIZE="-1">
<CODE>protected &nbsp;java.lang.String[]</CODE></FONT></TD>
<TD><CODE><B><A HREF="../../../../../com/enterprisedt/net/ftp/ssl/SSLFTPStandardValidator.html#serverCommonNames">serverCommonNames</A></B></CODE>

<BR>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Name with which the certificate's CommonName (CN) will be compared.</TD>
</TR>
</TABLE>
&nbsp;
<!-- ======== CONSTRUCTOR SUMMARY ======== -->

<A NAME="constructor_summary"><!-- --></A>
<TABLE BORDER="1" WIDTH="100%" CELLPADDING="3" CELLSPACING="0" SUMMARY="">
<TR BGCOLOR="#CCCCFF" CLASS="TableHeadingColor">
<TH ALIGN="left" COLSPAN="2"><FONT SIZE="+2">
<B>Constructor Summary</B></FONT></TH>
</TR>
<TR BGCOLOR="white" CLASS="TableRowColor">
<TD><CODE><B><A HREF="../../../../../com/enterprisedt/net/ftp/ssl/SSLFTPStandardValidator.html#SSLFTPStandardValidator()">SSLFTPStandardValidator</A></B>()</CODE>

<BR>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Default constructor.</TD>
</TR>
<TR BGCOLOR="white" CLASS="TableRowColor">
<TD><CODE><B><A HREF="../../../../../com/enterprisedt/net/ftp/ssl/SSLFTPStandardValidator.html#SSLFTPStandardValidator(boolean)">SSLFTPStandardValidator</A></B>(boolean&nbsp;checkHostNames)</CODE>

<BR>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Creates a standard validator with host-name checking enabled or disabled
 depending on the setting of the <code>hostNameCheckingEnabled</code>
 flag.</TD>
</TR>
<TR BGCOLOR="white" CLASS="TableRowColor">
<TD><CODE><B><A HREF="../../../../../com/enterprisedt/net/ftp/ssl/SSLFTPStandardValidator.html#SSLFTPStandardValidator(java.lang.String)">SSLFTPStandardValidator</A></B>(java.lang.String&nbsp;serverCommonName)</CODE>

<BR>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Creates a standard validator that will compare the CommonName on the 
 server certificate with the given string rather than the host-name.</TD>
</TR>
<TR BGCOLOR="white" CLASS="TableRowColor">
<TD><CODE><B><A HREF="../../../../../com/enterprisedt/net/ftp/ssl/SSLFTPStandardValidator.html#SSLFTPStandardValidator(java.lang.String[])">SSLFTPStandardValidator</A></B>(java.lang.String[]&nbsp;serverCommonNames)</CODE>

<BR>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Creates a standard validator that will compare the CommonName on the 
 server certificate each of the names in the given array rather than the host-name.</TD>
</TR>
</TABLE>
&nbsp;
<!-- ========== METHOD SUMMARY =========== -->

<A NAME="method_summary"><!-- --></A>
<TABLE BORDER="1" WIDTH="100%" CELLPADDING="3" CELLSPACING="0" SUMMARY="">
<TR BGCOLOR="#CCCCFF" CLASS="TableHeadingColor">
<TH ALIGN="left" COLSPAN="2"><FONT SIZE="+2">
<B>Method Summary</B></FONT></TH>
</TR>
<TR BGCOLOR="white" CLASS="TableRowColor">
<TD ALIGN="right" VALIGN="top" WIDTH="1%"><FONT SIZE="-1">
<CODE>protected &nbsp;boolean</CODE></FONT></TD>
<TD><CODE><B><A HREF="../../../../../com/enterprisedt/net/ftp/ssl/SSLFTPStandardValidator.html#checkChainLength(int)">checkChainLength</A></B>(int&nbsp;chainLength)</CODE>

<BR>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Checks the length of the certificate-chain, but making sure that it is
 less than or equal to <code>MAX_CERTIFICATE_CHAIN_LENGTH</code>.</TD>
</TR>
<TR BGCOLOR="white" CLASS="TableRowColor">
<TD ALIGN="right" VALIGN="top" WIDTH="1%"><FONT SIZE="-1">
<CODE>protected &nbsp;boolean</CODE></FONT></TD>
<TD><CODE><B><A HREF="../../../../../com/enterprisedt/net/ftp/ssl/SSLFTPStandardValidator.html#checkCommonName(java.lang.String, java.lang.String)">checkCommonName</A></B>(java.lang.String&nbsp;certCommonName,
                java.lang.String&nbsp;serverHostName)</CODE>

<BR>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Checks that the common name is the same as the server's host-name or
 (alternatively) one of the names passed into the constructor.</TD>
</TR>
<TR BGCOLOR="white" CLASS="TableRowColor">
<TD ALIGN="right" VALIGN="top" WIDTH="1%"><FONT SIZE="-1">
<CODE>protected &nbsp;boolean</CODE></FONT></TD>
<TD><CODE><B><A HREF="../../../../../com/enterprisedt/net/ftp/ssl/SSLFTPStandardValidator.html#checkDateRange(java.util.Date, java.util.Date)">checkDateRange</A></B>(java.util.Date&nbsp;validFrom,
               java.util.Date&nbsp;validUntil)</CODE>

<BR>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Checks that today's date falls between <code>validFrom</code> and
 <code>validTo</code>.</TD>
</TR>
<TR BGCOLOR="white" CLASS="TableRowColor">
<TD ALIGN="right" VALIGN="top" WIDTH="1%"><FONT SIZE="-1">
<CODE>&nbsp;boolean</CODE></FONT></TD>
<TD><CODE><B><A HREF="../../../../../com/enterprisedt/net/ftp/ssl/SSLFTPStandardValidator.html#validateServerCertificate(boolean, java.util.Vector, java.lang.String)">validateServerCertificate</A></B>(boolean&nbsp;recommendValidate,
                          java.util.Vector&nbsp;certificateChain,
                          java.lang.String&nbsp;serverHostName)</CODE>

<BR>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Applies the validation tests described in the class description (see
 above) and throws an exception if any of them fail.</TD>
</TR>
</TABLE>
&nbsp;<A NAME="methods_inherited_from_class_java.lang.Object"><!-- --></A>
<TABLE BORDER="1" WIDTH="100%" CELLPADDING="3" CELLSPACING="0" SUMMARY="">
<TR BGCOLOR="#EEEEFF" CLASS="TableSubHeadingColor">
<TH ALIGN="left"><B>Methods inherited from class java.lang.Object</B></TH>
</TR>
<TR BGCOLOR="white" CLASS="TableRowColor">
<TD><CODE>clone, equals, finalize, getClass, hashCode, notify, notifyAll, toString, wait, wait, wait</CODE></TD>
</TR>
</TABLE>
&nbsp;
<P>

<!-- ============ FIELD DETAIL =========== -->

<A NAME="field_detail"><!-- --></A>
<TABLE BORDER="1" WIDTH="100%" CELLPADDING="3" CELLSPACING="0" SUMMARY="">
<TR BGCOLOR="#CCCCFF" CLASS="TableHeadingColor">
<TH ALIGN="left" COLSPAN="1"><FONT SIZE="+2">
<B>Field Detail</B></FONT></TH>
</TR>
</TABLE>

<A NAME="MAX_CERTIFICATE_CHAIN_LENGTH"><!-- --></A><H3>
MAX_CERTIFICATE_CHAIN_LENGTH</H3>
<PRE>
public static int <B>MAX_CERTIFICATE_CHAIN_LENGTH</B></PRE>
<DL>
<DD>Maximum allowed length of the certificate chain. By default, this
 variable is set to 2, but it may be changed programmatically if a
 different length-limit is desired.
<P>
<DL>
</DL>
</DL>
<HR>

<A NAME="hostNameCheckingEnabled"><!-- --></A><H3>
hostNameCheckingEnabled</H3>
<PRE>
protected boolean <B>hostNameCheckingEnabled</B></PRE>
<DL>
<DD>Flag indicating whether or not host-name checking is enabled.
<P>
<DL>
</DL>
</DL>
<HR>

<A NAME="serverCommonNames"><!-- --></A><H3>
serverCommonNames</H3>
<PRE>
protected java.lang.String[] <B>serverCommonNames</B></PRE>
<DL>
<DD>Name with which the certificate's CommonName (CN) will be compared.
 If serverCommonName is set then the certificate's CN will be compared with
 it instead of the host-name.
<P>
<DL>
</DL>
</DL>
<HR>

<A NAME="rootCertificateStore"><!-- --></A><H3>
rootCertificateStore</H3>
<PRE>
protected <A HREF="../../../../../com/enterprisedt/net/ftp/ssl/SSLFTPCertificateStore.html" title="class in com.enterprisedt.net.ftp.ssl">SSLFTPCertificateStore</A> <B>rootCertificateStore</B></PRE>
<DL>
<DD>Reference to SSLFTPClient's root certificate store.
<P>
<DL>
</DL>
</DL>

<!-- ========= CONSTRUCTOR DETAIL ======== -->

<A NAME="constructor_detail"><!-- --></A>
<TABLE BORDER="1" WIDTH="100%" CELLPADDING="3" CELLSPACING="0" SUMMARY="">
<TR BGCOLOR="#CCCCFF" CLASS="TableHeadingColor">
<TH ALIGN="left" COLSPAN="1"><FONT SIZE="+2">
<B>Constructor Detail</B></FONT></TH>
</TR>
</TABLE>

<A NAME="SSLFTPStandardValidator()"><!-- --></A><H3>
SSLFTPStandardValidator</H3>
<PRE>
public <B>SSLFTPStandardValidator</B>()</PRE>
<DL>
<DD>Default constructor.  Creates a standard validator with host-name checking enabled.
<P>
</DL>
<HR>

<A NAME="SSLFTPStandardValidator(java.lang.String)"><!-- --></A><H3>
SSLFTPStandardValidator</H3>
<PRE>
public <B>SSLFTPStandardValidator</B>(java.lang.String&nbsp;serverCommonName)</PRE>
<DL>
<DD>Creates a standard validator that will compare the CommonName on the 
 server certificate with the given string rather than the host-name.
<P>
<DL>
<DT><B>Parameters:</B><DD><CODE>serverCommonName</CODE> - Name with which the certificate's CommonName (CN) will be compared.</DL>
</DL>
<HR>

<A NAME="SSLFTPStandardValidator(java.lang.String[])"><!-- --></A><H3>
SSLFTPStandardValidator</H3>
<PRE>
public <B>SSLFTPStandardValidator</B>(java.lang.String[]&nbsp;serverCommonNames)</PRE>
<DL>
<DD>Creates a standard validator that will compare the CommonName on the 
 server certificate each of the names in the given array rather than the host-name.
<P>
<DL>
<DT><B>Parameters:</B><DD><CODE>serverCommonName</CODE> - Name with which the certificate's CommonName (CN) will be compared.</DL>
</DL>
<HR>

<A NAME="SSLFTPStandardValidator(boolean)"><!-- --></A><H3>
SSLFTPStandardValidator</H3>
<PRE>
public <B>SSLFTPStandardValidator</B>(boolean&nbsp;checkHostNames)</PRE>
<DL>
<DD>Creates a standard validator with host-name checking enabled or disabled
 depending on the setting of the <code>hostNameCheckingEnabled</code>
 flag.  Disabling host-name checking is <b>strongly discouraged</b> and
 should be done only if the FTPS server's certificate cannot be
 configured so that its CN parameter contains its host-name.
 <p>
 Disabling host-name checking opens the opportunity for
 man-in-the-middle attacks. This scenario is when an attacker has stolen
 the certificate and private key of a server, and then set up another
 server using these with the aim of impersonating the former. Since
 internet naming is such that only one server can have a particular
 host-name, it is very difficult for the attacker to make their
 host-name match the host-name on the certificate. However, if the
 host-name is not matched with the name on the certificate then this
 possibility opens.
 </p>
<P>
<DL>
<DT><B>Parameters:</B><DD><CODE>checkHostNames</CODE> - Determines if host-names should be checked.</DL>
</DL>

<!-- ============ METHOD DETAIL ========== -->

<A NAME="method_detail"><!-- --></A>
<TABLE BORDER="1" WIDTH="100%" CELLPADDING="3" CELLSPACING="0" SUMMARY="">
<TR BGCOLOR="#CCCCFF" CLASS="TableHeadingColor">
<TH ALIGN="left" COLSPAN="1"><FONT SIZE="+2">
<B>Method Detail</B></FONT></TH>
</TR>
</TABLE>

<A NAME="checkChainLength(int)"><!-- --></A><H3>
checkChainLength</H3>
<PRE>
protected boolean <B>checkChainLength</B>(int&nbsp;chainLength)</PRE>
<DL>
<DD>Checks the length of the certificate-chain, but making sure that it is
 less than or equal to <code>MAX_CERTIFICATE_CHAIN_LENGTH</code>.
 <p>
 Code: 
 <pre>
 protected boolean checkChainLength(int chainLength) {
     return chainLength <= MAX_CERTIFICATE_CHAIN_LENGTH;
 }
 </pre>
<P>
<DD><DL>
</DL>
</DD>
<DD><DL>
<DT><B>Parameters:</B><DD><CODE>chainLength</CODE> - Length of the certificate chain.
<DT><B>Returns:</B><DD><code>true</code> if the chain is less than or equal to <code>MAX_CERTIFICATE_CHAIN_LENGTH</code>.</DL>
</DD>
</DL>
<HR>

<A NAME="checkCommonName(java.lang.String, java.lang.String)"><!-- --></A><H3>
checkCommonName</H3>
<PRE>
protected boolean <B>checkCommonName</B>(java.lang.String&nbsp;certCommonName,
                                  java.lang.String&nbsp;serverHostName)</PRE>
<DL>
<DD>Checks that the common name is the same as the server's host-name or
 (alternatively) one of the names passed into the constructor. The
 common name is the CN (Common Name) attribute of the server certificates
 subject.
 <p>
 Code: 
 <pre>
   if (serverCommonNames==null || !hostNameCheckingEnabled) {
     return certCommonName.toLowerCase().equals(serverHostName.toLowerCase());
   } else {
     for (int i=0; i<serverCommonNames.length; i++)
       if (certCommonName.toLowerCase().equals(serverCommonNames[i].toLowerCase()))
         return true;
       return false;
   }
 </pre>
 where serverCommonNames is the array of name that are optionally specified 
 in the constructor.
<P>
<DD><DL>
</DL>
</DD>
<DD><DL>
<DT><B>Parameters:</B><DD><CODE>certCommonName</CODE> - The CN (Common Name) attribute of the server certificates subject.<DD><CODE>serverHostName</CODE> - The server's hostname.
<DT><B>Returns:</B><DD>Result of a caseless comparison between <code>commonName</code>
 and <code>serverHostName</code> or (alternatively) one of the names passed into
 the constructor.</DL>
</DD>
</DL>
<HR>

<A NAME="checkDateRange(java.util.Date, java.util.Date)"><!-- --></A><H3>
checkDateRange</H3>
<PRE>
protected boolean <B>checkDateRange</B>(java.util.Date&nbsp;validFrom,
                                 java.util.Date&nbsp;validUntil)</PRE>
<DL>
<DD>Checks that today's date falls between <code>validFrom</code> and
 <code>validTo</code>.
 <p>
 Code: 
 <pre>
 protected boolean checkDateRange(Date validFrom, Date validUntil) {
     Date today = new Date();
     return !today.before(validFrom) && !today.after(validUntil);
 }
 </pre>
<P>
<DD><DL>
</DL>
</DD>
<DD><DL>
<DT><B>Parameters:</B><DD><CODE>validFrom</CODE> - Date that the server's certificate is valid from.<DD><CODE>validUntil</CODE> - Date that the server's certificate is valid from until.
<DT><B>Returns:</B><DD>true if date falls between input dates</DL>
</DD>
</DL>
<HR>

<A NAME="validateServerCertificate(boolean, java.util.Vector, java.lang.String)"><!-- --></A><H3>
validateServerCertificate</H3>
<PRE>
public boolean <B>validateServerCertificate</B>(boolean&nbsp;recommendValidate,
                                         java.util.Vector&nbsp;certificateChain,
                                         java.lang.String&nbsp;serverHostName)
                                  throws <A HREF="../../../../../com/enterprisedt/net/ftp/ssl/SSLFTPException.html" title="class in com.enterprisedt.net.ftp.ssl">SSLFTPException</A></PRE>
<DL>
<DD>Applies the validation tests described in the class description (see
 above) and throws an exception if any of them fail.
 <p>
 
 <pre>
 public boolean validateServerCertificate( 
     boolean recommendValidate,
     Vector certificateChain, 
     String serverHostName) 
     throws SSLFTPException {
     
     if (!recommendValidate)
                           return false;
 
     if (!checkChainLength(certificateChain.size())) 
         throw new SSLFTPException(...error message...);
 
     SSLFTPCertificate serverCertificate = (SSLFTPCertificate) certificateChain.lastElement();
 
     String commonName = serverCertificate.getSubjectName().getCommonName(); 
     if (!checkCommonName(commonName, serverHostName)) 
         throw new SSLFTPException(...error message...);
 
     if (!checkDateRange(serverCertificate.getValidityNotBefore(), 
                         serverCertificate.getValidityNotAfter())) 
         throw new SSLFTPException(...error message...);
 
     return true; 
 }
 </pre>
<P>
<DD><DL>
<DT><B>Specified by:</B><DD><CODE><A HREF="../../../../../com/enterprisedt/net/ftp/ssl/SSLFTPValidator.html#validateServerCertificate(boolean, java.util.Vector, java.lang.String)">validateServerCertificate</A></CODE> in interface <CODE><A HREF="../../../../../com/enterprisedt/net/ftp/ssl/SSLFTPValidator.html" title="interface in com.enterprisedt.net.ftp.ssl">SSLFTPValidator</A></CODE></DL>
</DD>
<DD><DL>
<DT><B>Parameters:</B><DD><CODE>recommendValidate</CODE> - flag indicating whether the client recommends
                 that the certificate should be accepted.  It will be 
                 <code>true</code> if the (1) the server's certificate was 
                 verified from the root certificates store (see
                 <A HREF="../../../../../com/enterprisedt/net/ftp/ssl/SSLFTPClient.html#getRootCertificateStore()"><CODE>SSLFTPClient.getRootCertificateStore()</CODE></A>).
                 or (2) server validation has been switched off 
                 see <A HREF="../../../../../com/enterprisedt/net/ftp/ssl/SSLFTPClient.html#setValidateServer(boolean)"><CODE>SSLFTPClient.setValidateServer(boolean)</CODE></A>).<DD><CODE>certificateChain</CODE> - chain of certificates (<code>SSLFTPCertificate</code>
                 objects) with the server's certificate appearing last and the
                 root certificate issuer (usually a Certificate Authority -
                 CA) appearing first. Under most circumstances, the vector has
                 only 2 elements; the certificate of the CA and the
                 certificate of the server.<DD><CODE>serverHostName</CODE> - the host-name of the server that we are connected to.
<DT><B>Returns:</B><DD><code>true</code> if the certificate is valid.  If the certificate
 is invalid then the method should either return <code>false</code> or throw 
 an <code>SSLFTPException</code> with details describing the failure.  
 If <code>false</code> is returned then a generic server certificate validation
 failure exception will be thrown.
<DT><B>Throws:</B>
<DD><CODE><A HREF="../../../../../com/enterprisedt/net/ftp/ssl/SSLFTPException.html" title="class in com.enterprisedt.net.ftp.ssl">SSLFTPException</A></CODE> - Thrown if the certificate is found to be invalid.</DL>
</DD>
</DL>
<!-- ========= END OF CLASS DATA ========= -->
<HR>


<!-- ======= START OF BOTTOM NAVBAR ====== -->
<A NAME="navbar_bottom"><!-- --></A>
<A HREF="#skip-navbar_bottom" title="Skip navigation links"></A>
<TABLE BORDER="0" WIDTH="100%" CELLPADDING="1" CELLSPACING="0" SUMMARY="">
<TR>
<TD COLSPAN=2 BGCOLOR="#EEEEFF" CLASS="NavBarCell1">
<A NAME="navbar_bottom_firstrow"><!-- --></A>
<TABLE BORDER="0" CELLPADDING="0" CELLSPACING="3" SUMMARY="">
  <TR ALIGN="center" VALIGN="top">
  <TD BGCOLOR="#EEEEFF" CLASS="NavBarCell1">    <A HREF="../../../../../overview-summary.html"><FONT CLASS="NavBarFont1"><B>Overview</B></FONT></A>&nbsp;</TD>
  <TD BGCOLOR="#EEEEFF" CLASS="NavBarCell1">    <A HREF="package-summary.html"><FONT CLASS="NavBarFont1"><B>Package</B></FONT></A>&nbsp;</TD>
  <TD BGCOLOR="#FFFFFF" CLASS="NavBarCell1Rev"> &nbsp;<FONT CLASS="NavBarFont1Rev"><B>Class</B></FONT>&nbsp;</TD>
  <TD BGCOLOR="#EEEEFF" CLASS="NavBarCell1">    <A HREF="class-use/SSLFTPStandardValidator.html"><FONT CLASS="NavBarFont1"><B>Use</B></FONT></A>&nbsp;</TD>
  <TD BGCOLOR="#EEEEFF" CLASS="NavBarCell1">    <A HREF="package-tree.html"><FONT CLASS="NavBarFont1"><B>Tree</B></FONT></A>&nbsp;</TD>
  <TD BGCOLOR="#EEEEFF" CLASS="NavBarCell1">    <A HREF="../../../../../deprecated-list.html"><FONT CLASS="NavBarFont1"><B>Deprecated</B></FONT></A>&nbsp;</TD>
  <TD BGCOLOR="#EEEEFF" CLASS="NavBarCell1">    <A HREF="../../../../../index-all.html"><FONT CLASS="NavBarFont1"><B>Index</B></FONT></A>&nbsp;</TD>
  <TD BGCOLOR="#EEEEFF" CLASS="NavBarCell1">    <A HREF="../../../../../help-doc.html"><FONT CLASS="NavBarFont1"><B>Help</B></FONT></A>&nbsp;</TD>
  </TR>
</TABLE>
</TD>
<TD ALIGN="right" VALIGN="top" ROWSPAN=3><EM>
</EM>
</TD>
</TR>

<TR>
<TD BGCOLOR="white" CLASS="NavBarCell2"><FONT SIZE="-2">
&nbsp;<A HREF="../../../../../com/enterprisedt/net/ftp/ssl/SSLFTPSecurityMechanism.html" title="class in com.enterprisedt.net.ftp.ssl"><B>PREV CLASS</B></A>&nbsp;
&nbsp;<A HREF="../../../../../com/enterprisedt/net/ftp/ssl/SSLFTPValidator.html" title="interface in com.enterprisedt.net.ftp.ssl"><B>NEXT CLASS</B></A></FONT></TD>
<TD BGCOLOR="white" CLASS="NavBarCell2"><FONT SIZE="-2">
  <A HREF="../../../../../index.html?com/enterprisedt/net/ftp/ssl/SSLFTPStandardValidator.html" target="_top"><B>FRAMES</B></A>  &nbsp;
&nbsp;<A HREF="SSLFTPStandardValidator.html" target="_top"><B>NO FRAMES</B></A>  &nbsp;
&nbsp;<SCRIPT type="text/javascript">
  <!--
  if(window==top) {
    document.writeln('<A HREF="../../../../../allclasses-noframe.html"><B>All Classes</B></A>');
  }
  //-->
</SCRIPT>
<NOSCRIPT>
  <A HREF="../../../../../allclasses-noframe.html"><B>All Classes</B></A>
</NOSCRIPT>


</FONT></TD>
</TR>
<TR>
<TD VALIGN="top" CLASS="NavBarCell3"><FONT SIZE="-2">
  SUMMARY:&nbsp;NESTED&nbsp;|&nbsp;<A HREF="#field_summary">FIELD</A>&nbsp;|&nbsp;<A HREF="#constructor_summary">CONSTR</A>&nbsp;|&nbsp;<A HREF="#method_summary">METHOD</A></FONT></TD>
<TD VALIGN="top" CLASS="NavBarCell3"><FONT SIZE="-2">
DETAIL:&nbsp;<A HREF="#field_detail">FIELD</A>&nbsp;|&nbsp;<A HREF="#constructor_detail">CONSTR</A>&nbsp;|&nbsp;<A HREF="#method_detail">METHOD</A></FONT></TD>
</TR>
</TABLE>
<A NAME="skip-navbar_bottom"></A>
<!-- ======== END OF BOTTOM NAVBAR ======= -->

<HR>
Copyright © 2001-2006 Enterprise Distributed Technologies Ltd. All Rights Reserved.
</BODY>
</HTML>
