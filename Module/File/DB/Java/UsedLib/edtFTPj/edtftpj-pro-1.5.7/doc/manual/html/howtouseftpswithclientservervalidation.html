<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN">
<html xmlns:mshelp="http://msdn.microsoft.com/mshelp">
<head>

  


  
  <title>How to use FTPS (with client/server validation)</title>
  <meta name="generator" content="HelpMaker.net">


  
  <meta name="keywords" content="Chapter 3,">


  
  <link rel="stylesheet" type="text/css" href="ms-help://Hx/HxRuntime/HxLink.css">


  
  <link rel="stylesheet" type="text/css" href="ms-help://Hx/HxRuntime/HxLinkDefault.css">
</head>


<body style="background-color: rgb(255, 255, 255);">

    
<table cellpadding="0" cellspacing="0" width="100%">

      <tbody>
    <tr>

        <td style="background-image: url(../images/bk_tl.jpg); background-repeat: repeat-x;"><img src="../images/space.gif" height="4" width="4"></td>

        <td style="background-image: url(../images/bk_t.jpg); background-repeat: repeat-x;"><img src="../images/space.gif" height="4" width="4"></td>

        <td style="background-image: url(../images/bk_tr.jpg); background-repeat: repeat-x;"><img src="../images/space.gif" height="4" width="4"></td>

      </tr>

      <tr>

        <td style="background-image: url(../images/bk_l.jpg); background-repeat: repeat-y;" width="4"><img src="../images/space.gif" height="4" width="4"></td>

        <td style="font-family: sans-serif; font-weight: bold; font-size: 14pt; background-image: url(../images/bk_c.jpg); background-repeat: repeat;" width="100%">
          &nbsp;How to use FTPS (with client/server validation)
        </td>

        <td style="background-image: url(../images/bk_r.jpg); background-repeat: repeat-y;" width="4"><img src="../images/space.gif" height="4" width="4"></td>

      </tr>

      <tr>

        <td style="background-image: url(../images/bk_bl.jpg); background-repeat: repeat-x;" height="4"><img src="../images/space.gif" height="4" width="4"></td>

        <td style="background-image: url(../images/bk_b.jpg); background-repeat: repeat-x;"><img src="../images/space.gif" height="4" width="4"></td>

        <td style="background-image: url(../images/bk_br.jpg); background-repeat: repeat-x;"><img src="../images/space.gif" height="4" width="4"></td>

      </tr>

    
  </tbody>
</table>

<br>

<div align="left"><font color="#010101" face="Arial"><span style="font-size: 10pt;">The
topic </span></font><a href="howtouseftpsintroduction.html"><font color="#0000ff" face="Arial"><span style="font-size: 10pt;"><u>How
to use FTPS (introduction)</u></span></font></a><font color="#010101" face="Arial"><span style="font-size: 10pt;"> describes
the FTPS features of </span></font><font color="#010101" face="Arial"><a href="../../api/com/enterprisedt/net/ftp/ssl/SSLFTPClient.html"><font color="#0000ff" face="Arial"><span style="font-size: 10pt;"><u>SSLFTPClient</u></span></font></a></font><font color="#010101" face="Arial"><span style="font-size: 10pt;"></span></font><font color="#010101" face="Arial"><span style="font-size: 10pt;"></span></font><font color="#010101" face="Arial"><span style="font-size: 10pt;">.&nbsp; This topic demonstrates
the use of FTPS with
server validation and
client authentication through client certificates.</span></font></div>
<font color="#ff0000" face="Arial"><span style="font-size: 10pt;"></span></font><br>




<div align="left"><a href="ms-help://edtFTPnetPRO/edtftpnetpro-api/EnterpriseDT.Net.Ftp.SecureFTPConnection.html"><font color="#010101" face="Arial"><span style="font-size: 10pt;"></span></font></a><a href="ms-help://edtFTPnetPRO/edtftpnetpro-api/EnterpriseDT.Net.Ftp.SecureFTPConnection.html"><font color="#010101" face="Arial"><span style="font-size: 10pt;"></span></font><font color="#010101" face="Arial"><span style="font-size: 10pt;"></span></font></a><font color="#010101" face="Arial">Client authentication
via certificates is unnecessary for many applications, as
username/password&nbsp;often provides a sufficient level of
authentication.
</font><font color="#010101" face="Arial"><span style="font-size: 10pt;"><br>


<br>


On the occasions where it is required,&nbsp;the client's
certificate and private key
must be supplied. Two formats are supported - the PEM format and Java
keystore.<br>

<br>

</span></font><font color="#010101" face="Arial"><span style="font-size: 10pt;">Note that for a client certificate to be validated by a server the certificate
must either be (1) installed on the server, or (2) have been issued by
a CA whose certificate is recognized by the server.</span></font><br>

<font color="#010101" face="Arial"><span style="font-size: 10pt;">
<br>


The PEM format certificate and private key must be formatted as below:<br>


<br>


</span></font>
<pre><span style="font-family: Lucida Console;"> -----BEGIN xxx PRIVATE KEY-----</span><br style="font-family: Lucida Console;"><span style="font-family: Lucida Console;"> ... client's private key ...</span><br style="font-family: Lucida Console;"><span style="font-family: Lucida Console;"> -----END xxx PRIVATE KEY-----</span><br style="font-family: Lucida Console;"><span style="font-family: Lucida Console;"> -----BEGIN CERTIFICATE-----</span><br style="font-family: Lucida Console;"><span style="font-family: Lucida Console;"> ... client's certificate ...</span><br style="font-family: Lucida Console;"><span style="font-family: Lucida Console;"> -----END CERTIFICATE-----</span><br></pre>


<br>


<font color="#010101" face="Arial"><span style="font-size: 10pt;">
where <code>xxx</code> defines the keytype which must be
either RSA or DSA.</span></font>
<font color="#010101" face="Arial"><span style="font-size: 10pt;"><br>


<br>


The&nbsp;<a href="../../api/com/enterprisedt/net/ftp/ssl/SSLFTPClient.html#loadClientCertificate%28java.lang.String,%20java.lang.String%29">loadClientCertificate</a>
	method is used to load the client's private key and certificate in PEM
	format from the supplied file.
	
<div align="left">
		<br>

		</div>

	
<div style="margin-left: 40px;">
		<font style="font-family: Lucida Console; font-size: 8pt;">
			ftp.<a href="../../api/com/enterprisedt/net/ftp/ssl/SSLFTPClient.html#loadClientCertificate%28java.lang.String,%20java.lang.String%29">loadClientCertificate</a>(clientCertFilename, clientKeyPassphrase);
		</font>
	</div>


	
<div align="left">
		<br>

		</div>


Alternatively, <a href="../../api/com/enterprisedt/net/ftp/ssl/SSLFTPClient.html#setClientCertificate%28java.security.cert.Certificate,%20java.security.PrivateKey%29">setClientCertificate</a>
can be used to supply a Java Certificate object and PrivateKey. </span></font><font style="font-family: Arial;">To load a certificate and a
private key from a Java keystore, code similar to the following should
be used:</font><br>


<font color="#010101" face="Arial"><span style="font-size: 10pt;"><br>


</span></font>
<div style="margin-left: 40px;"><font style="font-family: Lucida Console; font-size: 8pt;">KeyStore
keyStore =
KeyStore.getInstance("JKS"); </font><br>


<font style="font-family: Lucida Console; font-size: 8pt;">keyStore.load(new
FileInputStream(keyStoreFileName, keyStorePassword.toCharArray()); <br>


Certificate
certificate = keyStore.getCertificate(alias); </font><br>


<font style="font-family: Lucida Console; font-size: 8pt;">
	PrivateKey privateKey = 
	<br>
&nbsp;&nbsp;(PrivateKey)keyStore.getKey(alias, privateKeyPassword.toCharArray());
<br>
ftp.setClientCertificate(certificate, privateKey);
</font><br>


</div>


<font color="#010101" face="Arial"><span style="font-size: 10pt;"><br>

</span></font><font color="#010101" face="Arial"><a href="../../api/com/enterprisedt/net/ftp/ssl/SSLFTPClient.html"><font color="#0000ff" face="Arial"><span style="font-size: 10pt;"></span></font></a></font>
<font color="#010101" face="Arial"><span style="font-size: 10pt;">The
topic </span></font><a href="obtainingkeysandcertificates.html"><font color="#0000ff" face="Arial"><span style="font-size: 10pt;"><u>Obtaining Keys and
Certificates</u></span></font></a><font color="#010101" face="Arial"><span style="font-size: 10pt;">
for instructions on producing keys and certificates.
A general overview of private/public keys is presented in the topic </span></font><a href="publickeycryptography.html"><font color="#0000ff" face="Arial"><span style="font-size: 10pt;"><u>Public
Key Cryptography</u></span></font></a><font color="#010101" face="Arial"><span style="font-size: 10pt;">.</span></font></div>

<div style="margin-left: 13mm; margin-right: 0mm; text-indent: 0mm;" align="left"><font face="Lucida Console" size="1"><span style="font-size: 8pt;"><br>


<br>


</span></font></div>


<br>


<div style="margin-left: 13mm; margin-right: 0mm; text-indent: 0mm;" align="left"><font face="Lucida Console" size="1"><span style="font-size: 8pt;"><br>


<br>


</span></font></div>


<div align="left"><font color="#010101" face="Arial"><span style="font-size: 10pt;"></span></font></div>


<div align="left"></div>


<div align="left"></div>


</body>
</html>
