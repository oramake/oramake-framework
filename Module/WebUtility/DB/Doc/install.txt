title: Установка



group: Общие замечания

Реализуется с помощью целей сборки модуля из make-целей <Установка модуля в БД>.
Для корректной установки должна быть установлена актуальная версия OMS
( см. <Версия OMS-файлов>).

Параметры установки:
INSTALL_VERSION               - устанавливаемая версия модуля ( Last при
                                первоначальной установке или номер при
                                обновлении)
LOAD_OPERATORID               - логин и пароль оператора, выполняющего установку
                                ( формат: login/password)
LOAD_USERID                   - основной пользователь для установки в БД
                                ( формат: username/password@dbName)

Перед установкой модуль деактивирует пакетные задания модуля Scheduler в
БД, а после успешной установки восстанавливает активацию.

Команда для восстановления выполнения заданий в БД
на случай ошибок:

> make install-after LOAD_USERID=???/???@??? LOAD_OPERATORID=???/???



group: 1.1.3

Команда для установки обновления:

> make install INSTALL_VERSION=1.1.3 LOAD_USERID=???/???@??? LOAD_OPERATORID=???/???



group: 1.1.2

Команда для установки обновления:

> make install INSTALL_VERSION=1.1.2 LOAD_USERID=???/???@??? LOAD_OPERATORID=???/???



group: 1.1.1

Команда для установки обновления:

> make install INSTALL_VERSION=1.1.1 LOAD_USERID=???/???@??? LOAD_OPERATORID=???/???



group: 1.1.0

Команда для установки обновления:

(code)

make install INSTALL_VERSION=1.1.0 LOAD_USERID=???/???@??? LOAD_OPERATORID=???/???

(end)



group: 1.0.4

Нужно повторно выдать права на использование модуля пользователям, которым они
были выданы ранее (согласно <Выдача прав на использование модуля>).



group: 1.0.3

Команда для установки обновления:

(code)

make install INSTALL_VERSION=1.0.3 LOAD_USERID=???/???@??? LOAD_OPERATORID=???/???

(end)



group: 1.0.2

Предварительные требования:
- установка с использованием OraMakeSystem версии не ниже 2.1.0;

Команда для установки обновления:

(code)

make install INSTALL_VERSION=1.0.2 LOAD_USERID=???/???@??? LOAD_OPERATORID=???/???

(end)



group: 1.0.1

Команда для установки
обновления:

(code)

make install INSTALL_VERSION=1.0.1 LOAD_USERID=???/???@??? LOAD_OPERATORID=???/???

(end)



group: Первоначальная установка

Предварительные требования:
- наличие установленного модуля Logging ( SVN Root: Oracle/Module/Logging)
  версии не ниже 1.4.1;
- наличие прав на выполнение пакетов utl_http, dbms_lob и dbms_utility,
  иначе выполнить команду

(code)

make grant INSTALL_VERSION=Last LOAD_USERID=sys/???@??? LOAD_OPERATORID=???/??? GRANT_SCRIPT=sys-privs.sql TO_USERNAME=<MAIN_USER>

(end)

- пользователю, под которым выполняется установка, дожно быть доступно
  табличное пространство для индексов со стандартным именем ( см. скрипт
  OraMakeSystem/SqlScript/oms-set-indexTablespace.sql) либо используемое
  для индексов табличное пространство должно быть явно указано с помощью
  добавления в команду установки параметра <SQL_DEFINE> ( например, для
  создания индексов в табличном пространстве USERS в команду установки нужно
  добавить " SQL_DEFINE=indexTablespace=USERS");

Порядок первоначальной установки:

- установка объектов модуля

(code)

make install INSTALL_VERSION=Last LOAD_USERID=???/???@??? LOAD_OPERATORID=???/???

(end)

Замечания:
- для успешной отправки запросов может потребоваться выдать
  права ACL выполняющему процедуру пользователю (с помощью
  пакета dbms_network_acl_admin, можно использовать скрипт
  <Test/grant-host-access.sql>);



group: Выдача прав на использование модуля

Команда для выдачи прав на использование модуля другим пользователям БД:

(code)

make grant LOAD_USERID=???/???@??? LOAD_OPERATORID=???/??? TO_USERNAME=???

(end)

Замечания:
- для выдачи прав всем пользователям в качестве значения TO_USERNAME нужно
  указать PUBLIC;
- для выдачи прав необходимо наличие привилегии "CREATE ANY SYNONYM" в случае
  выдачи прав конкретному пользователю или "CREATE PUBLIC SYNONYM" в случае
  выдачи прав всем пользователям;
- для использования модуля должны быть права на использование пакетов
  utl_http, dbms_lob, dbms_utility;



group: Run tests

Prerequisites:
- install Option module;
- install TestUtility module;

Command to create the objects used to run
tests:

(code)

make install-test LOAD_USERID=???/???@??? LOAD_OPERATORID=???/???

(end)

Command for changing test parameters ( listed in
<pkg_WebUtilityTest::Test parameters>, the example sets URL for downloading
text data (<pkg_WebUtilityTest.TestHttpTextUrl_OptSName>) to
"http://www.example.com"):

(code)

make -B install-test LOAD_USERID=???/???@??? LOAD_OPERATORID=???/??? FILE_MASK=*/opt_option.sql SQL_DEFINE=TestHttpTextUrl=http://www.example.com

(end)

Command for run tests:

(code)

make test LOAD_USERID=???/???@??? LOAD_OPERATORID=???/???

(end)

Remarks:
- if error "ORA-24247: network access denied by access control list (ACL)"
  occurs during the tests, it is necessary to give the user access to the host;
  You can use script <Test/grant-test-host-access.sql> for granting
  access to all test hosts:

(code)

SQL> @WebUtility/DB/Test/grant-test-host-access.sql scott

(end)

  (grant user "scott" access to all hosts, specified in test parameters)

  Also you can use script <Test/grant-host-access.sql> for granting access
  to specified host:

(code)

SQL> @WebUtility/DB/Test/grant-host-access.sql *.example.com scott

(end)

  (grant user "scott" access to "*.example.com" hosts)
