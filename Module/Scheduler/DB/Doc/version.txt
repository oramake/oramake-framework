title: Версии



group: 5.2.1 ( 2019-12-30)

[!] Исключен немедленный перезапуск пакетного задания после прерывания его
    выполнения процедурой <pkg_Scheduler.abortBatch>.



group: 5.2.0 ( 2019-05-08)
(<Установка::5.2.0>)

[*] Replace oracle_job_id for activated_flag in <sch_batch>.

[*] Do not change JOB_QUEUE_PROCESSES parameter.

[!] Restart batch after kill of session (not work since version 5.0.0).



group: 5.1.0 ( 2019-04-16)

[-] Прекращена поддержка просмотра устаревших логов пакетных заданий
    (иерархического лога на базе поля parent_log_id, формировавшегося до
    установки версии 4.6.0), при этом:
    - удалены представления sch_message_type, v_sch_batch_result,
      v_sch_batch_root_log, v_sch_batch_root_log_old;
    - удален синоним sch_log и индексы sch_log_ix_root_batch_date_log,
      sch_log_ix_root_date_ins;

[*] Записи курсора, возвращаемого функцией поиска пакетных заданий
    <pkg_Scheduler.findBatch>, стали сортироваться по batch_short_name.

[*] Обеспечена возможность успешного выполнения функции
    <pkg_Scheduler.findOption> в случае указания optionId без batchId (такой
    вызов выполняется из App-части при изменении значения параметра
    пакетного задания).

[!] Восстановлена корректная работа скрипта <Do/activate-all.sql> в случае
    задания периода деактивации пакетных заданий (перестал работать начиная с
    версии 4.6.0).



group: 5.0.0 ( 2019-01-22)
(<Установка::5.0.0>)

[+] Использование модуля dbms_scheduler вместо dbms_job.

Difference from the previous versions:

- you cannot activate batch if the session is still active;

- after aborting batch it needs deactivation;



group: 4.6.0 ( 2018-10-29)

[*] Для логирования выполнения пакетных заданий стал использоваться контекст
    выполнения модуля Logging (вместо непосредственной вставки записей в
    таблицу лога с указанием родительской записи в parent_log_id).



group: 4.5.0 ( 2018-01-10)

[+] Локальные настройки модуля для БД хранятся в общих настройках для
    OraMakeSystem.

[+] Маркер в виде комментария /* batch: <Имя пакетного задания> */ для
    тела Oracle JOB и динамического SQL выполнения заданий.



group: 4.4.0 ( 2016-10-27)

[+] Добавлена процедура для переименования пакетного задания
    ( <pkg_SchedulerLoad.renameBatch>).

[*] Удалены ранее использовавшиеся последовательности sch_interval_type_seq
    и sch_message_type_seq ( в случае их наличия в БД).

[*] Добавлена возможность выполнения установки с деактивацивацией/активацией
    всех пакетных заданий вместо остановки выполнения заданий ( dbms_job) в БД
    ( в случае указания параметра установки STOP_JOB=0).

[!] Исключены ошибки при повторной загрузке задания с изменением его видимости
    ( например, задание уровня батча становится заданием уровня модуля и т.д.).

[!] При изменении модуля, к которому относится пакетное задание, обеспечено
    сохранение существующих параметров пакетного задания, включая их текущие
    значения ( ранее параметры пересоздавались по данным из XML-спецификации).



group: 4.3.5 ( 2016-10-06)

[+] В функции выгрузки настроек пакетного задания в XML
    ( <pkg_SchedulerLoad.createBatchConfigXml>) добавлена поддержка новых
    атрибутов параметров пакетных заданий ( атрибуты encryption, access_level и
    т.д.)

[*] Прекращено использование устаревшего интерфейса модуля Option.



group: 4.3.4.1 ( 2016-04-22)

[*] В скриптах первоначальной установки отражена передача таблиц sch_log и
    sch_message_type в модуль Logging ( при установке Logging версии 1.4.0).

[*] Использование представления <v_op_role> модуля AccessOperator вместо
    таблицы <op_role>.  Использование поля operator_name вместо operator_name_rus
    таблицы <op_operator>



group: 4.3.4 ( 2015-08-08)

[!] При загрузке конфигурации батча batch_config.xml отдельно от загрузки
    данных батча не учитывались данные элементов XML: retry_count, retry_interval;
    напротив, соответствующие параметры батча обновлялись при загрузке batch.xml
    даже в случае отсутствия задания конфигурации внутри batch.xml, таким образом
    при последовательной загрузке batch.xml без конфигурации и batch_config.xml
    соответствующие параметры батча сбрасывались ( null).



group: 4.3.3 ( 2015-03-05)

[!] При загрузке параметров пакетного задания из XML-файла обрезались данные
    с наименованием ( option_name, до 100 символов) и описанием
    ( option_description, до 500 символов) параметров ( ошибка присутствовала
    начиная с версии 4.1.0).



group: 4.3.2 ( 2014-10-14)

[*] В интерфейсе в списке модулей стали отображаться только те модули, у
    которых есть пакетные задания.

[!] Исключена ошибка "ORA-01031: insufficient privileges" при выборке из
    представления <v_sch_batch> под пользователем, не являющимся владельцем
    представления, но имеющим права на выборку из представления. Для этого
    получение данных из лога удалено из типа <sch_batch_log_info_t> и права на
    него выданы всем пользователям.



group: 4.3.1 ( 2014-10-08)

*Установка данной версии не требуется, т.к. проблема решена в версии 4.3.2.*

[!] В скрипт по выдаче прав на использование модуля ( <Install/Grant/Last/run.sql>)
    добавлена выдача прав на объект <sch_batch_log_info_t> для возможности
    выборки из <v_sch_batch>, так как иначе выдавалась ошибка:
    "ORA-00904: : invalid identifier".



group: 4.1.0 ( 2014-03-14)

[+] Добавлена возможность выдачи прав на все пакетные задания, созданные
    в определенной БД ( см. <pkg_SchedulerMain.LocalRoleSuffix_OptSName>).

[!] Удаление устаревших дублирующих публичных job-ов с временно заполненным
    job_short_name в результате миграции данных для 4.0.0.

[*] Для изменения расписания пакетного задания стала требоваться привилегия
    "WRITE" ( ранее "EXEC").

[*] Для изменения параметров пакетного задания стала требоваться привилегия
    "WRITE_OPT", показ закладки "Параметры" формы пакетные задания определяется
    наличием роли SchShowBatchOption ( наличие роли GlobalOptionAdmin не
    требуется).

[+] Расширены возможности загрузки параметров пакетного задания из XML-файла
    ( добавлены атрибуты encryption, access_level, description элемента option,
    атрибут instance для элементов со значением параметра, элементы value_list,
    prod_value_list, test_value_list, см.  <Описание::Реализация батча>).

[+] Для поддержки использования списка значений для переменой пакетного задания
    в процедуры setContext и функции getContext<Anydata|Date|Number|String>
    пакета <pkg_Scheduler> добавлен параметр valueIndex, а также добавлена
    функция getContextValueCount.

[+] Добавлен тип <sch_batch_option_t> для более удобной работы с параметрами
    пакетного задания.

[*] Для группировки пакетных вместо типа пакетного задания заданий стал
    использоваться прикладной модуль, к которому относится пакетное задание.
    Использование типа пакетного задания прекращено и связанные с ним объекты
    ( таблица sch_batch_type, поле batch_type_id) будут удалены в последующих
    версиях.

[*] Вместо настройки прав на тип пакетных заданий ( таблица
    sch_batch_type_role) стала использоваться настройка прав на все пакетные
    задания модуля ( таблица <sch_module_role_privilege>).

[+] Добавлены интерфейсные функции для параметров пакетных заданий.

[*] Вывод через dbms_output информационных сообщений о числе измененных записей
    в таблицах при загрузке пакетного задания из XML стал выполняться только
    при разрешенном уровне логирования INFO ( ранее выполнялся всегда).

[*] Функция getContextInteger пакета <pkg_Scheduler> переименована в
    getContextNumber ( функция со старым названием временно сохранена для
    обеспечения совместимости).

[*] Для решения проблемы с медленным отображением списка пакетных заданий в
    интерфейсе если не были заданы параметры поиска ( из-за длительной выборки
    в функции <pkg_Scheduler.findBatch>) изменена выборка в представлении
    <v_sch_batch> ( для исключения неэффективного плана запроса стал
    использоваться тип <sch_batch_log_info_t>).



group: 4.0.0 ( 2013-04-29)

[*] Перенос реализации батчей в прикладные модули ( см. <Описание>);

[+] Добавлены поля по языковым настройкам работы батчей.



group: 3.2.0 ( 2012-10-22)

[+] Добавлен скрипт для выдачи прав на использование модуля
    ( <Install/Grant/Last/run.sql>);



group: 3.1.2

[+] Добавлен скрипт для отмены установки модуля.

[*] Уточнено оформление скриптов первоначальной установки модуля.
